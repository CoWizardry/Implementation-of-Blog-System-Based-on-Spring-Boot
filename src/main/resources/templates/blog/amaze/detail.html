<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <title th:text="|${configurations.get('websiteName')} - ${pageName}|">主页</title>
    <meta name="description" th:content="${configurations.get('websiteDescription')}">
    <link rel="shortcut icon" th:href="@{${configurations.get('websiteIcon')}}"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta http-equiv="Window-target" content="_top"/>
    <link rel="stylesheet" th:href="@{/blog/amaze/css/base.css}">
    <!-- TailwindCSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .hljs {
            background: none;
        }
        pre code {
            white-space: pre;
        }

        blockquote {
            border-left: 4px solid #42b983;
            padding: 10px 0px 10px 15px;
            color: #777;
            background-color: rgba(66, 185, 131, .1);
            max-width: 890px;
        }
    </style>

</head>

<body class="bg-gray-100 text-gray-900">

<div th:replace="blog/amaze/header::nav-fragment"></div>

<header th:fragment="header-fragment" class="intro-header bg-cover bg-center py-16"
        th:style="'background-image:url(' + @{/blog/amaze/images/header.jpg} + ');'">
    <div class="container mx-auto text-center">
        <h1 class="text-4xl font-bold text-white" th:text="${blogDTO0.blogTitle}"></h1>
        <p class="mt-4 text-lg text-gray-300">
            <span th:text="${#dates.format(blogDTO0.createTime, 'yyyy-MM-dd')}"></span> &nbsp; • &nbsp;
            <a href="#comments" class="hover:underline" th:text="${blogDTO0.commentCount} + ' 条评论'"></a> &nbsp; • &nbsp;
            <span th:text="${blogDTO0.blogViews} + ' 浏览'"></span>
        </p>
        <div class="mt-4">
            <th:block th:each="tag : ${blogDTO0.blogTags}">
                <a class="bg-blue-600 text-white px-2 py-1 rounded-full text-sm hover:bg-blue-700"
                   th:href="@{'/tag/' + ${tag}}" th:text="${tag}"></a>&nbsp;
            </th:block>
        </div>
    </div>
</header>

<main class="container mx-auto max-w-screen-md py-8 px-4">
    <!-- 文章主体部分 -->
    <article class="bg-white p-8 rounded-lg shadow-lg border-b-4 border-blue-500">
        <div id="post-content" class="prose max-w-none">
            <!-- 使用Thymeleaf动态内容 -->
            <th:block th:utext="${blogDTO0.blogContent}"/>

            <!-- 版权声明 -->
            <aside class="mt-8 text-sm text-gray-500 border-t-2 pt-4">
                <p>本站文章除注明转载/出处外，皆为作者原创，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文链接，否则保留追究法律责任的权利。</p>
            </aside>
        </div>
    </article>
    <style>
        @media only screen and (min-width: 750px) {
            pre {
                max-width: 100%;
            }
        }
    </style>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // 获取 <article> 内的所有相关标签
            const article = document.querySelector("#post-content");

            // 为 h1 标签添加样式
            article.querySelectorAll("h1").forEach(function(h1) {
                h1.classList.add("text-4xl", "font-bold", "text-gray-900", "mb-6");
            });

            // 为 h2 标签添加样式
            article.querySelectorAll("h2").forEach(function(h2) {
                h2.classList.add("text-3xl", "font-semibold", "text-gray-800", "mt-8", "mb-4");
            });

            // 为 h3 标签添加样式
            article.querySelectorAll("h3").forEach(function(h3) {
                h3.classList.add("text-2xl", "font-medium", "text-gray-700", "mt-6", "mb-3");
            });
            // 为 h4 标签添加样式
            article.querySelectorAll("h4").forEach(function(h4) {
                h4.classList.add("text-xl", "font-semibold", "text-gray-600", "mt-5", "mb-2");
            });

            // 为 h5 标签添加样式
            article.querySelectorAll("h5").forEach(function(h5) {
                h5.classList.add("text-lg", "font-medium", "text-gray-500", "mt-4", "mb-1");
            });

            // 为 h6 标签添加样式
            article.querySelectorAll("h6").forEach(function(h6) {
                h6.classList.add("text-base", "font-medium", "text-gray-400", "mt-3", "mb-1");
            });

            // 为 p 标签添加样式
            article.querySelectorAll("p").forEach(function(p) {
                p.classList.add("text-lg", "text-gray-800", "leading-relaxed");
            });

            // 为 blockquote 标签添加样式
            article.querySelectorAll("blockquote").forEach(function(blockquote) {
                blockquote.classList.add("border-l-4", "border-blue-400", "pl-4", "text-gray-700", "italic", "my-6");
            });

            // 为 hr 标签添加样式
            article.querySelectorAll("hr").forEach(function(hr) {
                hr.classList.add("my-8", "border-t-2", "border-gray-300");
            });

            // 为 a 标签添加样式
            article.querySelectorAll("a").forEach(function(a) {
                a.classList.add("text-blue-600", "hover:text-blue-800", "underline");
            });
            // 为 code 和 pre 标签添加样式
            article.querySelectorAll("pre").forEach(function(pre) {
                pre.classList.add("bg-gray-100", "p-4", "rounded-lg", "overflow-x-auto");
            });
            article.querySelectorAll("code").forEach(function(code) {
                code.classList.add("font-mono", "text-sm", "bg-gray-200", "p-1", "rounded");
            });
        });
    </script>


    <!-- 评论区 -->
    <section class="mt-12">
        <h2 class="text-3xl font-bold text-gray-900 border-b-2 pb-2 mb-6">评论</h2>
        <div class="space-y-8">
            <th:block th:if="${null != commentPageResult}">
                <th:block th:each="comment, iterStat : ${commentPageResult.list}">
                    <article class="bg-gray-100 p-4 rounded-lg shadow-md">
                        <header class="flex items-center space-x-4">
                            <img th:src="@{/blog/default/img/avatar.png}" alt="Avatar" class="w-12 h-12 rounded-full">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900" th:text="${comment.commentator}"></h3>
                                <span class="text-sm text-gray-600"
                                      th:text="'评论时间：' + ${#dates.format(comment.commentCreateTime, 'yyyy-MM-dd HH:mm:ss')}"></span>
                            </div>
                        </header>
                        <div class="mt-4 text-gray-800" th:text="${comment.commentBody}"></div>
                    </article>

                    <th:block th:unless="${#strings.isEmpty(comment.replyBody)}">
                        <article class="bg-gray-200 p-4 rounded-lg shadow-sm ml-8 border-l-4 border-blue-400">
                            <header class="flex items-center space-x-4">
                                <img th:src="@{${configurations.get('yourAvatar')}}" alt="Avatar" class="w-10 h-10 rounded-full">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-900" th:text="${configurations.get('yourName')}">十三</h3>
                                    <span class="text-sm text-gray-600"
                                          th:text="'回复时间：' + ${#dates.format(comment.replyCreateTime, 'yyyy-MM-dd HH:mm:ss')}"></span>
                                </div>
                            </header>
                            <div class="mt-4 text-gray-800" th:text="${comment.replyBody}"></div>
                        </article>
                    </th:block>
                </th:block>
            </th:block>
        </div>

        <!-- 评论表单 -->
        <th:block th:if="${blogDTO0.enableComment==0}">
            <aside class="mt-12 bg-white p-6 rounded-lg shadow-lg border-t-4 border-blue-500">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">添加评论</h2>
                <form id="commentForm" class="space-y-4">
                    <input type="hidden" id="blogId" name="blogId" th:value="${blogDTO0.blogId}">
                    <input type="text" name="commentator" id="commentator" placeholder="(*必填)怎么称呼你?" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <input type="email" name="email" id="email" placeholder="(*必填)你的联系邮箱" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <input type="text" name="websiteUrl" id="websiteUrl" placeholder="你的网站地址(可不填)" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <div class="flex items-center space-x-4">
                        <input type="text" name="verifyCode" id="verifyCode" placeholder="(*必填)请输入验证码" class="w-1/2 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <img alt="单击图片刷新！" class="cursor-pointer rounded-full" th:src="@{/common/kaptcha}" onclick="this.src='/common/kaptcha?d='+new Date()*1">
                    </div>
                    <textarea rows="5" name="commentBody" id="commentBody" placeholder="(*必填)请输入你的评论" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                    <div class="text-center">
                        <button id="commentSubmit" type="button" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">提交</button>
                    </div>
                </form>
            </aside>
        </th:block>
    </section>
</main>


<footer th:replace="blog/amaze/footer::footer-fragment"></footer>

</body>

<script th:src="@{/blog/default/js/jquery.min.js}"></script>
<script th:src="@{/blog/plugins/highlight/highlight.pack.js}"></script>
<script th:src="@{/blog/plugins/comment/valid.js}"></script>
<script th:src="@{/blog/plugins/comment/comment.js}"></script>
<script th:src="@{/admin/plugins/sweetalert/sweetalert.min.js}"></script>
<script>
    $(function () {
        $("#back-top").hide();
        $(window).scroll(function () {
            if ($(this).scrollTop() > 300) {
                $('#back-top').fadeIn();
            } else {
                $('#back-top').fadeOut();
            }
        });
        // scroll body to 0px on click
        $('#back-top a').click(function () {
            $('body,html').animate({
                scrollTop: 0
            }, 800);
            return false;
        });

        $('pre code').each(function (i, block) {
            hljs.highlightBlock(block);
        });

        $('article h1, article h2, article h3, article h4, article h5').find('a').removeAttr('target')
    })
</script>

</html>
